# gmnd 操作マニュアル

このドキュメントでは、Discord Bot `gmnd` の日常的な操作、管理、およびトラブルシューティングについて説明します。

## 1. ユーザー向け操作

### 1.1 対話の開始
- **常駐チャンネル**: 管理者が設定した「常駐チャンネル」では、Bot へのメンションなしで直接話しかけることができます。
- **メンション**: 常駐チャンネル以外では、`@gmnd` のように Bot へメンションを付けてメッセージを送信してください。

### 1.2 ファイルの送信（マルチモーダル）
- 画像 (PNG, JPG) や PDF ファイルを添付してメッセージを送信すると、AI がその内容を解析して回答します。
- 「この資料を要約して」「この画像は何？」といった指示が可能です。

## 2. コマンドリファレンス（Slash Commands）

一般ユーザーおよび管理者が利用可能なコマンドの一覧です。

| コマンド | 引数 | 対象 | 説明 |
| :--- | :--- | :--- | :--- |
| `/help` | なし | 全員 | 利用可能なコマンドと使い方のヘルプを表示します。 |
| `/status` | なし | 全員 | Bot の稼働状態を確認します。 |
| `/model` | `name` | 全員 | 使用する Gemini モデル（例: `gemini-1.5-flash`, `gemini-1.5-pro`）を切り替えます。 |
| `/config` | `key`, `value` | 管理者 | 常駐チャンネル ID 等の動作設定を更新します。 |
| `/set_system` | `prompt` | 管理者 | そのチャンネルでの Bot の「人格（システムプロンプト）」を設定します。 |
| `/clear_context`| `scope` | 管理者 | 会話履歴を消去します。確認ボタンが表示されます。 |

## 3. 管理者向け運用

### 3.1 履歴の自動要約
- 毎日 **AM 03:00 (JST)** に、その日の会話ログが自動的に要約され、アーカイブ（`archive.txt`）へ保存されます。
- `current.txt` は要約後にリセットされ、翌日の会話に備えます。

### 3.2 ログの確認
- システムの動作状況やエラーは実行ディレクトリの `system.log` に出力されます。
- 起動に失敗する場合や AI の応答がない場合は、このファイルを確認してください。

### 3.3 文脈の直接編集
- `data/[GuildID]/[ChannelID]/` 配下のテキストファイルを直接編集することで、AI に与える文脈を微調整することが可能です。
- `system.txt`: 人格設定
- `current.txt`: 直近の会話
- `archive.txt`: 過去の要約
